{"componentChunkName":"component---src-templates-blog-post-js","path":"/javascript/nodejs-event-loop-2/","result":{"data":{"site":{"siteMetadata":{"title":"Jaehyeon's Dev Blog","author":"Jaehyeon Kim","siteUrl":"https://jaehyeon48.github.io","comment":{"disqusShortName":"","utterances":"jaehyeon48/blog-comments"}}},"markdownRemark":{"id":"bceaa0c3-9053-5c12-88a3-588e5e21da5d","excerpt":"1ë¶€ ë³´ëŸ¬ê°€ê¸° Poll phase Poll phase ì—ì„œëŠ” ì¼ì •ì‹œê°„ë™ì•ˆ ëŒ€ê¸°(blocking)í•˜ë©´ì„œ ìƒˆë¡œìš´ I/O operationì´ ë“¤ì–´ì˜¤ëŠ”ì§€ â€œpolling(watching)â€œí•œë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ê°€ Poll phaseì— ì§„ì…í•˜ë©´ ìš°ì„   ë¥¼ ì‚´í´ë³´ê³ , í•´ë‹¹ íì— íŒŒì¼ ì½ê¸° ì½œë°±, TCPâ€¦","html":"<p><a href=\"../nodejs_event_loop_1/\">1ë¶€ ë³´ëŸ¬ê°€ê¸°</a></p>\n<hr class=\"custom-hr\">\n<h3 id=\"poll-phase\" style=\"position:relative;\"><a href=\"#poll-phase\" aria-label=\"poll phase permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"18\" height=\"18\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"link\" viewBox=\"0 0 512 512\"><path fill=\"#05b166\" d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"></path></svg></a>Poll phase</h3>\n<p>Poll phase ì—ì„œëŠ” ì¼ì •ì‹œê°„ë™ì•ˆ ëŒ€ê¸°(blocking)í•˜ë©´ì„œ ìƒˆë¡œìš´ I/O operationì´ ë“¤ì–´ì˜¤ëŠ”ì§€ â€œpolling(watching)â€œí•œë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ê°€ Poll phaseì— ì§„ì…í•˜ë©´ ìš°ì„  <code class=\"language-text\">watcher_queue</code> ë¥¼ ì‚´í´ë³´ê³ , í•´ë‹¹ íì— íŒŒì¼ ì½ê¸° ì½œë°±, TCP í†µì‹  ì½œë°±ë“±ê³¼ ê°™ì€ ì‘ì—…ë“¤ì´ ì¡´ì¬í•œë‹¤ë©´ í•´ë‹¹ ì‘ì—…ë“¤ì„ ìˆ˜í–‰í•œë‹¤.</p>\n<p>ì´ ë•Œ ë”ì´ìƒ ì‹¤í–‰í•  ì½œë°±ì´ ì—†ëŠ” ìƒíƒœì— ì´ë¥´ê²Œ ë˜ë©´ <code class=\"language-text\">pending_queue</code>, <code class=\"language-text\">check_queue</code> (<code class=\"language-text\">setImmediate</code> ì˜ ì½œë°±ë“¤ì´ ì €ì¥ë¨), <code class=\"language-text\">closing_callbacks_queue</code> (<code class=\"language-text\">close</code> ì´ë²¤íŠ¸ ì½œë°±ë“¤ì´ ì €ì¥ë¨)ì— ì €ì¥ëœ ì‘ì—…ë“¤ì´ ìˆëŠ”ì§€ ì‚´í´ë³¸ë‹¤. ë§Œì•½ í•´ì•¼ í•  ì‘ì—…ì´ ìˆë‹¤ë©´ ì¦‰ì‹œ Poll phaseë¥¼ ì¢…ë£Œí•˜ê³  ë‹¤ìŒ phaseë¡œ ë„˜ì–´ê°„ë‹¤. ë§Œì•½ í•´ì•¼ í•  ì‘ì—…ì´ ì—†ë‹¤ë©´ Poll phaseì—ì„œ ì¼ì • ì‹œê°„ë™ì•ˆ ëŒ€ê¸°í•œë‹¤.</p>\n<p>ê·¸ëŸ¼ ê³¼ì—° ì–¼ë§ˆë‚˜ ëŒ€ê¸°í•˜ëŠ”ì§€ë¥¼ ì½”ë“œë¥¼ í†µí•´ ì‚´í´ë³´ì. ìš°ì„  Poll phaseì˜ ë©”ì†Œë“œì¸ <code class=\"language-text\">uv__poll</code> (UNIXëŠ” <code class=\"language-text\">uv__io_poll</code>) ì˜ ì¸ì ëª©ë¡ì„ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤ (ë©”ì†Œë“œ ì „ì²´ëŠ” ë„ˆë¬´ ê¸¸ê¸°ë•Œë¬¸ì— ìƒëµí•œë‹¤).</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">uv__io_poll</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uv_loop_t</span><span class=\"token operator\">*</span> loop<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> timeout<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì²« ë²ˆì§¸ ì¸ìë¡œ ì´ë²¤íŠ¸ ë£¨í”„ë¥¼, ë‘ ë²ˆì§¸ ì¸ìë¡œ â€œëŒ€ê¸° ì‹œê°„â€ì„ ë°›ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ Poll phaseëŠ” ì¸ìë¡œ ì–¼ë§ˆë§Œí¼ì˜ ì‹œê°„ë™ì•ˆ ëŒ€ê¸°í•  ê²ƒì¸ê°€ë¥¼ ë°›ì•„ì„œ í•´ë‹¹ ì‹œê°„ë§Œí¼ ëŒ€ê¸°í•œë‹¤.</p>\n<p>ë§Œì•½ <code class=\"language-text\">timeout</code> ê°’ì´ 0ì´ë©´ pollingì„ ê±´ë„ˆë›°ê³  ë°”ë¡œ ë‹¤ìŒ phaseì¸ Check phaseë¡œ ë„˜ì–´ê°„ë‹¤. <code class=\"language-text\">timeout</code> ê°’ì€ ë‹¤ìŒ ê³¼ì •ì„ í†µí•´ ê³„ì‚°ëœë‹¤:</p>\n<ul>\n<li>ë§Œì•½ ì´ë²¤íŠ¸ ë£¨í”„ê°€ í˜„ì¬ <code class=\"language-text\">UV_RUN_DEFAULT</code> ëª¨ë“œë¡œ ë™ì‘í•œë‹¤ë©´ <code class=\"language-text\">timeout</code> ì€ <code class=\"language-text\">uv_backend_timeout</code> ë©”ì†Œë“œë¥¼ í†µí•´ ê³„ì‚°ëœë‹¤.</li>\n<li>ë§Œì•½ ì´ë²¤íŠ¸ ë£¨í”„ê°€ í˜„ì¬ <code class=\"language-text\">UV_RUN_ONCE</code> ëª¨ë“œë¡œ ë™ì‘í•˜ê³  <code class=\"language-text\">uv_run_pending</code> ì˜ ë¦¬í„´ê°’ì´ 0 (ì¦‰, <code class=\"language-text\">pending_queue</code> ê°€ ë¹„ì–´ìˆëŠ” ê²½ìš°) ì´ë©´ <code class=\"language-text\">timeout</code> ì€ <code class=\"language-text\">uv_backend_timeout</code> ë©”ì†Œë“œë¥¼ í†µí•´ ê³„ì‚°ëœë‹¤.</li>\n<li>ì´ì™¸ì˜ ê²½ìš°, <code class=\"language-text\">timeout</code> ì€ 0ì´ë‹¤.</li>\n</ul>\n<p>ì´ë²¤íŠ¸ ë£¨í”„ì˜ ëª¨ë“œì— ê´€í•œ ìì„¸í•œ ë‚´ìš©ì€ <a href=\"http://docs.libuv.org/en/v1.x/loop.html#c.uv_run\" target=\"_blank\" rel=\"noreferrer noopener\">http://docs.libuv.org/en/v1.x/loop.html#c.uv_run</a> ë¥¼ ì°¸ê³ í•˜ê¸¸ ë°”ë€ë‹¤.</p>\n<br/>\n<p><code class=\"language-text\">uv_backend_timeout</code> ë©”ì†Œë“œì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// https://github.com/nodejs/node/blob/c61870c376e2f5b0dbaa939972c46745e21cdbdd/deps/uv/src/unix/core.c#L337</span>\n<span class=\"token comment\">// https://github.com/nodejs/node/blob/e46c680bf2b211bbd52cf959ca17ee98c7f657f5/deps/uv/src/win/core.c#L398</span>\n<span class=\"token comment\">// UNIX ë²„ì „</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">uv_backend_timeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token class-name\">uv_loop_t</span><span class=\"token operator\">*</span> loop<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loop<span class=\"token operator\">-></span>stop_flag <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">uv__has_active_handles</span><span class=\"token punctuation\">(</span>loop<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">uv__has_active_reqs</span><span class=\"token punctuation\">(</span>loop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">QUEUE_EMPTY</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>loop<span class=\"token operator\">-></span>idle_handles<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">QUEUE_EMPTY</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>loop<span class=\"token operator\">-></span>pending_queue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loop<span class=\"token operator\">-></span>closing_handles<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token function\">uv__next_timeout</span><span class=\"token punctuation\">(</span>loop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ìœ„ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, ë‹¤ìŒ ì¤‘ í•˜ë‚˜ì— í•´ë‹¹ë˜ëŠ” ê²½ìš° <code class=\"language-text\">timeout</code> ì€ 0ì´ë‹¤.</p>\n<ul>\n<li>ë£¨í”„ì˜ <code class=\"language-text\">stop_flag</code> ê°€ 0ì´ ì•„ë‹Œê²½ìš° (ì¦‰, ë£¨í”„ë¥¼ ì¢…ë£Œí•´ì•¼ í•˜ëŠ” ê²½ìš°).</li>\n<li>í˜„ì¬ activeí•œ í•¸ë“¤ëŸ¬(ì½œë°±)ê°€ ì—†ê³ , í˜„ì¬ activeí•œ ìš”ì²­(operation)ì´ ì—†ëŠ” ê²½ìš°.</li>\n<li>ì‹¤í–‰ë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” idleí•œ í•¸ë“¤ëŸ¬ê°€ ìˆëŠ” ê²½ìš°.</li>\n<li><code class=\"language-text\">pending_queue</code> ì—ì„œ ëŒ€ê¸° ì¤‘ì¸(pending) I/O ì½œë°±ì´ ìˆëŠ” ê²½ìš° (ì¦‰, ì´ë¯¸ ëŒ€ê¸° ì¤‘ì¸ I/O ë™ì‘ì´ ìˆìœ¼ë¯€ë¡œ ìƒˆë¡œìš´ I/O ë™ì‘ì„ ê¸°ë‹¤ë¦´ í•„ìš”ê°€ ì—†ìŒ).</li>\n<li><code class=\"language-text\">close</code> ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ìˆëŠ” ê²½ìš°.</li>\n</ul>\n<p>ìœ„ ë‹¤ì„¯ê°œì˜ ìƒí™©ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ê²½ìš°, <code class=\"language-text\">uv__next_timeout</code> ì„ í˜¸ì¶œí•˜ì—¬ <code class=\"language-text\">timeout</code> ì„ ê³„ì‚°í•œë‹¤. ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// https://github.com/nodejs/node/blob/e46c680bf2b211bbd52cf959ca17ee98c7f657f5/deps/uv/src/timer.c#L142</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">uv__next_timeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token class-name\">uv_loop_t</span><span class=\"token operator\">*</span> loop<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">heap_node</span><span class=\"token operator\">*</span> heap_node<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token class-name\">uv_timer_t</span><span class=\"token operator\">*</span> handle<span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\">uint64_t</span> diff<span class=\"token punctuation\">;</span>\n\n  heap_node <span class=\"token operator\">=</span> <span class=\"token function\">heap_min</span><span class=\"token punctuation\">(</span><span class=\"token function\">timer_heap</span><span class=\"token punctuation\">(</span>loop<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>heap_node <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* block indefinitely */</span>\n\n  handle <span class=\"token operator\">=</span> <span class=\"token function\">container_of</span><span class=\"token punctuation\">(</span>heap_node<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uv_timer_t</span><span class=\"token punctuation\">,</span> heap_node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>handle<span class=\"token operator\">-></span>timeout <span class=\"token operator\">&lt;=</span> loop<span class=\"token operator\">-></span>time<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  diff <span class=\"token operator\">=</span> handle<span class=\"token operator\">-></span>timeout <span class=\"token operator\">-</span> loop<span class=\"token operator\">-></span>time<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>diff <span class=\"token operator\">></span> INT_MAX<span class=\"token punctuation\">)</span>\n    diff <span class=\"token operator\">=</span> INT_MAX<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> diff<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">uv__next_timeout</code> ì€ í˜„ì¬ ì‹œê°„(iterationì„ ì‹œì‘í•  ë•Œ ê³„ì‚°í•œ ì‹œê°„)ì„ ê¸°ì¤€ìœ¼ë¡œ ê°€ì¥ ê°€ê¹Œìš´ íƒ€ì´ë¨¸ì™€ì˜ ì°¨ì´ë¥¼ ë°˜í™˜í•œë‹¤. ì¦‰, ì´ ê²½ìš° ì´ë²¤íŠ¸ ë£¨í”„ê°€ Poll phaseì—ì„œ ê°€ì¥ ë¹¨ë¦¬ ë§Œë£Œë˜ëŠ” íƒ€ì´ë¨¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì‹œê°„ì´ ë ë•Œê¹Œì§€ë§Œ ê¸°ë‹¤ë¦¬ë‹¤ê°€ ë‹¤ìŒ phaseë¡œ ë„˜ì–´ê°„ë‹¤.</p>\n<p>ì´ ë•Œ ë§Œì•½ íƒ€ì´ë¨¸ê°€ ì—†ë‹¤ë©´ <code class=\"language-text\">-1</code> ì„ ë¦¬í„´í•˜ëŠ”ë°, ì´ë¡œì¸í•´ ì´ë²¤íŠ¸ ë£¨í”„ê°€ Poll phaseì—ì„œ ë¬´í•œíˆ ê¸°ë‹¤ë¦¬ê²Œ ëœë‹¤.</p>\n<br/>\n<ul>\n<li>\n<p>ì¢…í•©í•´ë³´ìë©´, ì´ë²¤íŠ¸ ë£¨í”„ëŠ” Poll phaseì—ì„œ</p>\n<ol>\n<li>Check phase í˜¹ì€ Close phaseì— ì‹¤í–‰í•  ì½œë°±ì´ ìˆìœ¼ë©´ Poll phaseì—ì„œ ê¸°ë‹¤ë¦¬ì§€ ì•ŠëŠ”ë‹¤.</li>\n<li>ë§Œì•½ Check phase ì™€ Close phaseì— ì‹¤í–‰í•  ì½œë°±ì´ ì—†ìœ¼ë©´ íƒ€ì´ë¨¸ë¥¼ ì‚´í´ë³´ê³ , íƒ€ì´ë¨¸ê°€ ìˆìœ¼ë©´ í•´ë‹¹ íƒ€ì´ë¨¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì„ ë•Œê¹Œì§€ Poll phaseì—ì„œ ê¸°ë‹¤ë ¸ë‹¤ê°€ ë‹¤ìŒ phaseë¡œ ë„˜ì–´ê°„ë‹¤.</li>\n<li>ë§Œì•½ íƒ€ì´ë¨¸ë„ ì—†ìœ¼ë©´ ì¼ì´ ìƒê¸¸ë•Œ ê¹Œì§€ Poll phaseì—ì„œ ëŒ€ê¸°í•œë‹¤.</li>\n</ol>\n</li>\n</ul>\n<p>I/O í´ë§ì´ ìˆ˜í–‰ë˜ëŠ” ë°©ì‹ì€ OSë³„ë¡œ ì°¨ì´ê°€ ìˆë‹¤. Windowsì˜ ê²½ìš°, IOCP(Input Output Completion Port)ì˜ <code class=\"language-text\">GetQueuedCompletionStatus</code> ë¥¼ ì´ìš©í•˜ê³ , Linuxì˜ ê²½ìš° <code class=\"language-text\">epoll_wait</code> ì„, macOSì˜ ê²½ìš° <code class=\"language-text\">kqueue</code> ë¥¼ ì´ìš©í•œë‹¤.</p>\n<h3 id=\"check-phase\" style=\"position:relative;\"><a href=\"#check-phase\" aria-label=\"check phase permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"18\" height=\"18\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"link\" viewBox=\"0 0 512 512\"><path fill=\"#05b166\" d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"></path></svg></a>Check phase</h3>\n<p>Check phaseì˜ ë™ì‘ ë°©ì‹ì€ Timer phaseì™€ ë¹„ìŠ·í•˜ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ íƒ€ì´ë¨¸ ì½œë°±(<code class=\"language-text\">setTimeout()</code>, <code class=\"language-text\">setInterval()</code>) ë“¤ì´ ì–¸ì œ ì‹¤í–‰ë˜ëŠ”ì§€ ë³´ì¥ë˜ì§€ ì•ŠëŠ” ë°˜ë©´, <code class=\"language-text\">setImmediate</code> ì˜ ì½œë°±ë“¤ì€ I/O phase ë°”ë¡œ ë‹¤ìŒì— ì²˜ë¦¬ë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤.</p>\n<br/>\n<blockquote>\n<p>setTimeout vs. setImmediate</p>\n</blockquote>\n<p>ì´ ê¸€ì˜ ì²« ë¶€ë¶„ì—ì„œ ë´¤ë˜ ì´ë²¤íŠ¸ ë£¨í”„ì˜ íë¦„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ë£¨í”„ì˜ iterationì´ ì‹œì‘ë˜ê³  ìš°ì„  Timer phaseì— ì§„ì…í•˜ì—¬ íƒ€ì´ë¨¸ ê´€ë ¨ ì½œë°±ë“¤ì„ ì²˜ë¦¬í•˜ê³ , ê·¸ ë‹¤ìŒì— I/O phase ë¥¼ ê±°ì³ Check phaseì— ì§„ì…í•˜ë¯€ë¡œ ë‹¤ìŒ ì½”ë“œì˜ ê²°ê³¼ë¥¼ ì‰½ê²Œ ì˜ˆì¸¡í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setTimeout'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setImmediate'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì–¸ëœ» ë³´ê¸°ì—” <code class=\"language-text\">setTimeout</code> ì´ ë¨¼ì € ì‹¤í–‰ë˜ê³  ê·¸ ë‹¤ìŒ <code class=\"language-text\">setImmediate</code> ê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤. í•˜ì§€ë§Œ ìœ„ ì½”ë“œì˜ ê²°ê³¼ëŠ” <strong>ì˜ˆì¸¡í•  ìˆ˜ ì—†ë‹¤!</strong> ğŸ˜± ìœ„ ì½”ë“œë¥¼ ì—¬ëŸ¬ë²ˆ ì‹¤í–‰í•´ë³´ë©´ ì„œë¡œ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>\n<figure>\n    <img src=\"https://cdn.jsdelivr.net/gh/jaehyeon48/jaehyeon48.github.io@master/assets/images/javascript/nodejs_event_loop/setImmediate_1.png\" alt=\"setTimeout vs. setImmediate\">\n    <figcaption>setTimeout vs. setImmediate</figcaption>\n</figure>\n<p>ì´ëŸ¬í•œ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” ì´ìœ ëŠ”, Timer phaseì—ì„œ ì‚´í´ë³¸ ê²ƒê³¼ ê°™ì´ <code class=\"language-text\">setTimeout</code> ì˜ default ë”œë ˆì´ ê°’ì€ 0ì´ ì•„ë‹ˆë¼ 1ì´ê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ë§Œì•½ 0ë³´ë‹¤ ì‘ì€ ê°’ì„ ë”œë ˆì´ë¡œ ì£¼ê²Œ ë˜ë©´ Node.jsê°€ ìë™ì ìœ¼ë¡œ ë”œë ˆì´ë¥¼ 1ë¡œ ë³€ê²½í•´ë²„ë¦°ë‹¤.</p>\n<p>ë”°ë¼ì„œ, ì´ë²¤íŠ¸ ë£¨í”„ê°€ í˜„ì¬ ì‹œê°„ì„ ê³„ì‚°í•  ë•Œ, CPUê°€ ì–¼ë§ˆë‚˜ ë°”ìœì§€ì— ë”°ë¼ ì‹œê°„ì„ ê³„ì‚°í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì´ <code class=\"language-text\">1ms</code> ë¥¼ ì´ˆê³¼í•  ìˆ˜ë„, ê·¸ë ‡ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤. ë§Œì•½ <code class=\"language-text\">1ms</code> ë³´ë‹¤ ë¹ ë¥´ê²Œ ì‹œê°„ì„ ê³„ì‚°í–ˆë‹¤ë©´ <code class=\"language-text\">setImmediate</code> ê°€ ë¨¼ì € ì‹¤í–‰ë  ê²ƒì´ê³ , ì‹œê°„ì„ ê³„ì‚°í•˜ëŠ”ë° <code class=\"language-text\">1ms</code> ë³´ë‹¤ ë” ê±¸ë ¸ë‹¤ë©´ <code class=\"language-text\">setTimeout</code> ì´ ì‹¤í–‰ë  ê²ƒì´ë‹¤.</p>\n<p>í•˜ì§€ë§Œ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œëŠ” <strong>ë¬´ì¡°ê±´</strong> <code class=\"language-text\">setImmediate</code> ì˜ ì½œë°±ì´ <code class=\"language-text\">setTimeout</code> ì½œë°±ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ëœë‹¤ê³  í•  ìˆ˜ ìˆë‹¤:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span>\n\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">readFile</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setTimeout'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'setImmediate'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ê·¸ ì´ìœ ëŠ” ìš°ì„ , í”„ë¡œê·¸ë¨ì´ ì‹œì‘ë˜ë©´ <code class=\"language-text\">fs.readFile()</code> ì„ ì´ìš©í•˜ì—¬ íŒŒì¼ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì½ëŠ”ë‹¤. íŒŒì¼ ì½ê¸°ê°€ ì™„ë£Œë˜ë©´ <code class=\"language-text\">pending_queue</code> ì— ì½œë°±ì´ ì €ì¥ë˜ì–´ ì¶”í›„ì— ì‹¤í–‰ë˜ëŠ”ë°, ì´ ë•Œ <code class=\"language-text\">setTimeout</code> ê³¼ <code class=\"language-text\">setImmediate</code> ì´ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³ , ê°ê°ì˜ ì½œë°±ì´ Timer phaseì˜ íì™€ Check phaseì˜ íì— ì €ì¥ëœë‹¤.</p>\n<ul>\n<li>I/O phase ë¥¼ ì§€ë‚˜ Poll phaseì— ì§„ì…í–ˆì„ ë•Œ, immediate ì½œë°±ê³¼ íƒ€ì´ë¨¸ ì½œë°±ì´ ìˆìœ¼ë¯€ë¡œ ê³§ì¥ Check phaseë¡œ ê°€ì„œ <code class=\"language-text\">setImmediate</code> ì˜ ì½œë°±ì„ ì‹¤í–‰í•œë‹¤. â†’ â€œsetImmediateâ€ ì¶œë ¥.</li>\n<li>ê·¸ ë‹¤ìŒ ë£¨í”„ iterationì—ì„œ Timer phaseì— ì§„ì…í•˜ì—¬ ë§Œë£Œëœ íƒ€ì´ë¨¸ì˜ ì½œë°±ì„ ì‹¤í–‰í•œë‹¤ â†’ â€œsetTimeoutâ€ ì¶œë ¥.</li>\n</ul>\n<h3 id=\"close-phase\" style=\"position:relative;\"><a href=\"#close-phase\" aria-label=\"close phase permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"18\" height=\"18\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"link\" viewBox=\"0 0 512 512\"><path fill=\"#05b166\" d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"></path></svg></a>Close phase</h3>\n<p><code class=\"language-text\">'close'</code> ì´ë²¤íŠ¸, í˜¹ì€ <code class=\"language-text\">socket.destroy()</code> ì™€ ê°™ì€ <code class=\"language-text\">destroy</code> íƒ€ì…ì— ëŒ€í•œ ì½œë°±ë“¤ì„ ì‹¤í–‰í•œë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ê°€ Close phaseë¥¼ ë§ˆì¹˜ê³  ë‚˜ë©´ <code class=\"language-text\">uv__loop_alive</code> ë¥¼ ì´ìš©í•˜ì—¬ iterationì„ ë” ëŒì•„ì•¼ í•˜ëŠ”ì§€ íŒë‹¨í•œë‹¤.</p>\n<h2 id=\"nexttickqueue--microtaskqueue\" style=\"position:relative;\"><a href=\"#nexttickqueue--microtaskqueue\" aria-label=\"nexttickqueue  microtaskqueue permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"18\" height=\"18\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"link\" viewBox=\"0 0 512 512\"><path fill=\"#05b166\" d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"></path></svg></a>nextTickQueue &#x26; microTaskQueue</h2>\n<p><code class=\"language-text\">process.nextTick()</code> ì˜ ì½œë°±ë“¤ì´ ì €ì¥ë˜ëŠ” <code class=\"language-text\">nextTickQueue</code> ì™€, <code class=\"language-text\">Promise</code> ë“±ì˜ ì½œë°±ì´ ì €ì¥ë˜ëŠ” <code class=\"language-text\">microTaskQueue</code> ëŠ” ì‚¬ì‹¤ ì´ë²¤íŠ¸ ë£¨í”„ì˜ ì¼ë¶€ê°€ ì•„ë‹ˆë‹¤.</p>\n<p>Node.js v11.0.0 ì´ì „ì—ëŠ” ê° tickë§ˆë‹¤, ì¦‰ ì–´ë–¤ phaseì—ì„œ ë‹¤ìŒ phaseë¡œ ë„˜ì–´ê°ˆ ë•Œ (â†’ â€œC++/JavaScript ê²½ê³„ë¥¼ ë„˜ì„ ë•Œâ€ ë¼ê³  í•˜ê¸°ë„ í•œë‹¤) í•´ë‹¹ íì— ì €ì¥ëœ ëª¨ë“  ì½œë°±ë“¤ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í–ˆë‹¤. ì´ ë•Œ <code class=\"language-text\">nextTickQueue</code> ê°€ <code class=\"language-text\">microTaskQueue</code> ë³´ë‹¤ ë†’ì€ ìš°ì„ ìˆœìœ„ë¥¼ ê°–ëŠ”ë‹¤.</p>\n<p>í•˜ì§€ë§Œ Node.js v11.0.0 ë¶€í„°ëŠ” ë™ì‘ ë°©ì‹ì´ ì•½ê°„ ë°”ë€Œì—ˆëŠ”ë°, ê¸°ì¡´ ë°©ì‹ì²˜ëŸ¼ ê° tickë§ˆë‹¤ ë‘ ê°œì˜ íë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ê° íƒ€ì´ë¨¸ ì½œë°±(<code class=\"language-text\">setImmediate</code> &#x26; <code class=\"language-text\">setInterval</code>) ê³¼ immediate ì½œë°± ì‚¬ì´ì— <code class=\"language-text\">nextTick</code> ì½œë°±ì™€ <code class=\"language-text\">microTask</code> ì½œë°±ì´ ì‹¤í–‰ëœë‹¤. ë‹¤ìŒ ì½”ë“œë¥¼ ì‚´í´ë³´ì:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timeout1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timeout2'</span><span class=\"token punctuation\">)</span>\n  Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'promise resolve'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timeout3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timeout4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Node.js v11.0.0 ì´í›„ ë²„ì „ì—ì„œ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:</li>\n</ul>\n<figure>\n    <img src=\"https://cdn.jsdelivr.net/gh/jaehyeon48/jaehyeon48.github.io@master/assets/images/javascript/nodejs_event_loop/nextTickQueue_1.png\" alt=\"code result after v11.0.0\">\n</figure>\n<ul>\n<li>Node.js v11.0.0 ì´ì „ ë²„ì „ì—ì„œ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:</li>\n</ul>\n<figure>\n    <img src=\"https://cdn.jsdelivr.net/gh/jaehyeon48/jaehyeon48.github.io@master/assets/images/javascript/nodejs_event_loop/nextTickQueue_2.png\" alt=\"code result before v11.0.0 \">\n</figure>\n<p>ìœ„ ê²°ê³¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, v11.0.0 ì´ì „ì—ëŠ” ë§¤ tickë§ˆë‹¤ <code class=\"language-text\">nextTick</code> ì½œë°±ê³¼ <code class=\"language-text\">microTask</code> ì½œë°±ë“¤ì´ ì‹¤í–‰ëìœ¼ë‚˜, v11.0.0 ì´í›„ì—ëŠ” íƒ€ì´ë¨¸ ì½œë°±, (ìœ„ ì½”ë“œì—ëŠ” ì—†ì§€ë§Œ) immediate ì½œë°± ë§ˆë‹¤ <code class=\"language-text\">nextTick</code> ì½œë°±ê³¼ <code class=\"language-text\">microTask</code> ì½œë°±ì„ ì‹¤í–‰í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>\n<p>ì´ë ‡ê²Œ ë™ì‘ì´ ë³€ê²½ëœ ì´ìœ ëŠ”, í¬ë¡¬ ë¸Œë¼ìš°ì €ì™€ì˜ í˜¸í™˜ì„± ë•Œë¬¸ì¸ë°, ë¸Œë¼ìš°ì €ì—ì„œëŠ” v11.0.0 ì´í›„ ë²„ì „ì—ì„œì™€ ê°™ì´ ë™ì‘í•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>\n<p>ë¬¼ë¡  <code class=\"language-text\">setImmediate</code> ì— ëŒ€í•´ ì‹¤í—˜í•´ ë´ë„ ìœ„ì™€ ë™ì¼í•œ ë¡œì§ìœ¼ë¡œ ë™ì‘í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'immediate1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'immediate2'</span><span class=\"token punctuation\">)</span>\n  Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'promise resolve'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'immediate3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">setImmediate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'immediate4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Node.js v11.0.0 ì´í›„ ë²„ì „:</p>\n<figure>\n    <img src=\"https://cdn.jsdelivr.net/gh/jaehyeon48/jaehyeon48.github.io@master/assets/images/javascript/nodejs_event_loop/setImmediate_2.png\" alt=\"code result after v11.0.0\">\n</figure>\n<p>Node.js v11.0.0 ì´ì „ ë²„ì „:</p>\n<figure>\n    <img src=\"https://cdn.jsdelivr.net/gh/jaehyeon48/jaehyeon48.github.io@master/assets/images/javascript/nodejs_event_loop/setImmediate_3.png\" alt=\"code result before v11.0.0 \">\n</figure>\n<h2 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"18\" height=\"18\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"link\" viewBox=\"0 0 512 512\"><path fill=\"#05b166\" d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"></path></svg></a>REFERENCES</h2>\n<p><a href=\"http://docs.libuv.org/en/v1.x/guide/basics.html#event-loops\" target=\"_blank\" rel=\"noreferrer noopener\">Basics of libuv - libuv documentation</a></p>\n<p><a href=\"http://docs.libuv.org/en/v1.x/design.html#the-i-o-loop\" target=\"_blank\" rel=\"noreferrer noopener\">Design overview - libuv documentation</a></p>\n<p><a href=\"https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/\" target=\"_blank\" rel=\"noreferrer noopener\">The Node.js Event Loop, Timers, and process.nextTick()</a></p>\n<p><a href=\"https://blog.insiderattack.net/event-loop-and-the-big-picture-nodejs-event-loop-part-1-1cb67a182810\" target=\"_blank\" rel=\"noreferrer noopener\">Event Loop and the Big Picture Series</a></p>\n<p><a href=\"https://www.voidcanvas.com/nodejs-event-loop/\" target=\"_blank\" rel=\"noreferrer noopener\">Node.js event loop workflow &#x26; lifecycle in low level</a></p>","frontmatter":{"title":"Node.jsì˜ ì´ë²¤íŠ¸ ë£¨í”„ Part2","date":"August 19, 2020","category":"JavaScript"}}},"pageContext":{"slug":"/javascript/nodejs-event-loop-2/","previous":null,"next":{"fields":{"slug":"/javascript/limiting-scope-exposure-1/"},"frontmatter":{"title":"ìë°”ìŠ¤í¬ë¦½íŠ¸ ë³€ìˆ˜ ë…¸ì¶œ ìµœì†Œí™” í•˜ê¸° Part1"}}}},"staticQueryHashes":[]}